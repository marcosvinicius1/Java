/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package br.com.atmatech.sac.view;

import br.com.atmatech.sac.beans.ReportBeans;
import br.com.atmatech.sac.beans.ViewsBeans;
import br.com.atmatech.sac.dao.GerencialDao;
import br.com.atmatech.sac.dao.ReportDao;
import br.com.atmatech.sac.dao.ViewsDao;
import br.com.atmatech.sac.report.ReportGerencial;
import java.awt.event.MouseEvent;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import javax.swing.DefaultCellEditor;
import javax.swing.DefaultListModel;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author MARCOS
 */
public class ViewRelatorio extends javax.swing.JPanel {

    /**
     * Creates new form ViewModulo
     */
    List<ViewsBeans> lvb = new ArrayList<>();

    public ViewRelatorio() {
        initComponents();
        buscaViews();
        jCbviews.setEditable(false);
        jTviewnome.setVisible(false);
        jDaguarde.setUndecorated(true);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jDaguarde = new javax.swing.JDialog();
        jLabel21 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jBnovo = new javax.swing.JButton();
        jBsalvar = new javax.swing.JButton();
        jBalterar = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jCbviews = new com.jidesoft.swing.AutoCompletionComboBox();
        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jLviewcampos = new javax.swing.JList();
        jButton1 = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        JComboBox combobox=new JComboBox();
        combobox.setModel(new javax.swing.DefaultComboBoxModel(new String[]{"","=",">","<","<>",">=","<=","CONTEM","NÃO CONTEM"}) );
        jTviewcampos = new javax.swing.JTable();
        jTviewnome = new javax.swing.JTextField();
        jCnomereport = new javax.swing.JComboBox();
        jTviewdescricao = new javax.swing.JTextField();

        jDaguarde.setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        jDaguarde.setBackground(new java.awt.Color(255, 51, 51));
        jDaguarde.setMinimumSize(new java.awt.Dimension(247, 90));
        jDaguarde.setModal(true);
        jDaguarde.setResizable(false);

        jLabel21.setForeground(new java.awt.Color(255, 0, 51));
        jLabel21.setText("AGUARDE....");

        javax.swing.GroupLayout jDaguardeLayout = new javax.swing.GroupLayout(jDaguarde.getContentPane());
        jDaguarde.getContentPane().setLayout(jDaguardeLayout);
        jDaguardeLayout.setHorizontalGroup(
            jDaguardeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jDaguardeLayout.createSequentialGroup()
                .addContainerGap(91, Short.MAX_VALUE)
                .addComponent(jLabel21, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(77, 77, 77))
        );
        jDaguardeLayout.setVerticalGroup(
            jDaguardeLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jDaguardeLayout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addComponent(jLabel21)
                .addContainerGap(26, Short.MAX_VALUE))
        );

        setPreferredSize(new java.awt.Dimension(799, 613));

        jPanel1.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jBnovo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/atmatech/sac/icon/Knob Add.png"))); // NOI18N
        jBnovo.setText("VISUALIZAR");
        jBnovo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBnovoActionPerformed(evt);
            }
        });

        jBsalvar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/atmatech/sac/icon/Knob Valid Blue.png"))); // NOI18N
        jBsalvar.setText("NOVO");
        jBsalvar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBsalvarActionPerformed(evt);
            }
        });

        jBalterar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/com/atmatech/sac/icon/Knob Attention.png"))); // NOI18N
        jBalterar.setText("Alterar");
        jBalterar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBalterarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jBnovo)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jBsalvar)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jBalterar)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jBalterar, jBnovo, jBsalvar});

        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jBnovo)
                    .addComponent(jBsalvar)
                    .addComponent(jBalterar))
                .addContainerGap())
        );

        jPanel1Layout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[] {jBalterar, jBnovo, jBsalvar});

        jPanel2.setPreferredSize(new java.awt.Dimension(779, 294));

        jLabel1.setText("Visualizações");

        jLviewcampos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jLviewcamposMouseClicked(evt);
            }
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jLviewcamposMousePressed(evt);
            }
        });
        jScrollPane1.setViewportView(jLviewcampos);

        jButton1.setText("...");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jTviewcampos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Campos", "Agrupar", "Condicao", "Valor"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Boolean.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, true, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTviewcampos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTviewcamposMouseClicked(evt);
            }
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jTviewcamposMousePressed(evt);
            }
        });
        jScrollPane4.setViewportView(jTviewcampos);
        jTviewcampos.getColumn(jTviewcampos.getColumnName(2)).setCellEditor(new DefaultCellEditor(combobox));

        jTviewnome.setEditable(false);

        jCnomereport.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCnomereportItemStateChanged(evt);
            }
        });

        jTviewdescricao.setEditable(false);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel1)
                    .addComponent(jCbviews, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 262, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(29, 29, 29)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jTviewdescricao, javax.swing.GroupLayout.PREFERRED_SIZE, 224, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jTviewnome, javax.swing.GroupLayout.PREFERRED_SIZE, 185, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jCnomereport, javax.swing.GroupLayout.PREFERRED_SIZE, 312, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jTviewnome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jTviewdescricao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jCbviews, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1)
                    .addComponent(jCnomereport, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(35, 35, 35)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 338, Short.MAX_VALUE)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addContainerGap(73, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, 808, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, 511, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        List<ViewsBeans> lvbl = new ViewsDao().getViewsCampos(jCbviews.getSelectedItem().toString());
        DefaultListModel lista = new DefaultListModel();
        jLviewcampos.removeAll();
        for (ViewsBeans vb : lvbl) {

            lista.addElement(vb.getCampos().trim());

        }
        jLviewcampos.setModel(lista);
        jTviewnome.setText(lvb.get(jCbviews.getSelectedIndex()).getNome().trim());
        jTviewdescricao.setText(jCbviews.getSelectedItem().toString());
        getReport(jTviewnome.getText());
        DefaultTableModel tabela = (DefaultTableModel) jTviewcampos.getModel();
        tabela.setNumRows(0);
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jLviewcamposMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLviewcamposMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jLviewcamposMouseClicked

    private void jLviewcamposMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLviewcamposMousePressed
        // TODO add your handling code here:
        DefaultTableModel viewcampos = (DefaultTableModel) jTviewcampos.getModel();
        if (evt.getClickCount() == 2) {
            if (jTviewcampos.getRowCount() < 5) {
                if(verCamposAdc(jLviewcampos.getSelectedValue().toString())){
                   viewcampos.addRow(new Object[]{jLviewcampos.getSelectedValue().toString(), false, "", ""}); 
                }                
            }

        }
    }//GEN-LAST:event_jLviewcamposMousePressed

    private void jBnovoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBnovoActionPerformed
        // TODO add your handling code here:        
        if (jTviewcampos.getRowCount() > 0) {

            new Thread(new Runnable() {
            @Override
            public void run() {
                jDaguarde.setLocationRelativeTo(null);
                jDaguarde.setVisible(true);
            }
        }).start();

            new Thread(new Runnable() {

                @Override
                public void run() {
                    getRelatorio();
                    jDaguarde.setVisible(false);
                }
            }).start();
        }
    }//GEN-LAST:event_jBnovoActionPerformed

    private void jTviewcamposMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTviewcamposMousePressed
        // TODO add your handling code here:            
        if (jTviewcampos.getSelectedColumn() == 1) {
            for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
                if (i != jTviewcampos.getSelectedRow()) {
                    jTviewcampos.setValueAt(false, i, 1);
                }
            }
        }
    }//GEN-LAST:event_jTviewcamposMousePressed

    private void jTviewcamposMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTviewcamposMouseClicked
        // TODO add your handling code here:
        if (((evt.getModifiers() & MouseEvent.BUTTON3_MASK) != 0) & (jTviewcampos.getSelectedRow() >= 0)) {
            // if (evt.getClickCount() == 2) {
            DefaultTableModel modelo = (DefaultTableModel) jTviewcampos.getModel();
            modelo.removeRow(jTviewcampos.getSelectedRow());
            //}
        }

    }//GEN-LAST:event_jTviewcamposMouseClicked

    private void jBsalvarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBsalvarActionPerformed
        // TODO add your handling code here:
        if (jTviewcampos.getRowCount() > 0) {
            String nomereport = JOptionPane.showInputDialog("Digite o Nome do Relatório");
            if (nomereport != null) {
                if (!nomereport.equals("")) {
                    setReport(nomereport.toUpperCase(), jTviewnome.getText());
                } else {
                    JOptionPane.showMessageDialog(this, "Digite um Nome Para o Relatório", "Relatório", JOptionPane.WARNING_MESSAGE);
                }
            }
        }

    }//GEN-LAST:event_jBsalvarActionPerformed

    private void jCnomereportItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jCnomereportItemStateChanged
        // TODO add your handling code here:
        if(jCnomereport.getItemCount()>0){
             getCamposReport(jTviewnome.getText(), jCnomereport.getSelectedItem().toString());
        }
       
    }//GEN-LAST:event_jCnomereportItemStateChanged

    private void jBalterarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBalterarActionPerformed
        // TODO add your handling code here:
        if ((jCnomereport.getSelectedIndex() > -0)&&(jTviewcampos.getRowCount()>0)) {
            System.out.println("foi");
            updateReport(jCnomereport.getSelectedItem().toString(), jTviewnome.getText());
        }
        
    }//GEN-LAST:event_jBalterarActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBalterar;
    private javax.swing.JButton jBnovo;
    private javax.swing.JButton jBsalvar;
    private javax.swing.JButton jButton1;
    private com.jidesoft.swing.AutoCompletionComboBox jCbviews;
    private javax.swing.JComboBox jCnomereport;
    private javax.swing.JDialog jDaguarde;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JList jLviewcampos;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JTable jTviewcampos;
    private javax.swing.JTextField jTviewdescricao;
    private javax.swing.JTextField jTviewnome;
    // End of variables declaration//GEN-END:variables

    private void buscaViews() {
        jCbviews.removeAllItems();
        lvb = new ViewsDao().getViews();
        for (ViewsBeans vb : lvb) {
            jCbviews.addItem(vb.getDescricao());
        }
    }

    private void getRelatorio() {

        int j = 0;
        String group = "";
        List lista = new ArrayList();
        //verifica os campos do relatorio
        for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
            lista.add(jTviewcampos.getValueAt(i, 0));
        }
        String[] campos = (String[]) lista.toArray(new String[lista.size()]);

        //verifica o agrupamento
        for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
            if (Boolean.valueOf(jTviewcampos.getValueAt(i, 1).toString())) {
                group = jTviewcampos.getValueAt(i, 0).toString();
            }
        }

        // verifica condicao de pesquisa
        List lista2 = new ArrayList();
        for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
            if (!jTviewcampos.getValueAt(i, 2).equals("")) {
                if (lista2.isEmpty()) {
                    if (jTviewcampos.getValueAt(i, 2).equals("CONTEM")) {
                        lista2.add(jTviewcampos.getValueAt(i, 0).toString() + " like " + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    } else if (jTviewcampos.getValueAt(i, 2).equals("NÃO CONTEM")) {
                        lista2.add(jTviewcampos.getValueAt(i, 0).toString() + " not like " + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    }else {
                        lista2.add(jTviewcampos.getValueAt(i, 0).toString() + jTviewcampos.getValueAt(i, 2).toString() + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    }
                } else {
                    if (jTviewcampos.getValueAt(i, 2).equals("CONTEM")) {
                        lista2.add("and " + jTviewcampos.getValueAt(i, 0).toString() + " like " + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    } else if (jTviewcampos.getValueAt(i, 2).equals("NÃO CONTEM")) {
                        lista2.add(jTviewcampos.getValueAt(i, 0).toString() + " not like " + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    }else {
                        lista2.add("and " + jTviewcampos.getValueAt(i, 0).toString() + jTviewcampos.getValueAt(i, 2).toString() + "'" + jTviewcampos.getValueAt(i, 3).toString().toUpperCase() + "'");
                    }
                }
            }
        }
        String[] condicao = (String[]) lista2.toArray(new String[lista2.size()]);        
       

        //faz a pesquisa do relatorio
        List<String[]> valores = new ArrayList<>();
        if ((group.equals("")) && (condicao.length > 0)) {
            valores = new GerencialDao().getView(campos, jTviewnome.getText(), condicao);
        } else if (!(group.equals("")) && (condicao.length > 0)) {
            valores = new GerencialDao().getView(campos, jTviewnome.getText(), group, condicao);
        } else if ((group.equals("")) && (condicao.length == 0)) {
            valores = new GerencialDao().getView(campos, jTviewnome.getText());
        } else if (!(group.equals("")) && (condicao.length == 0)) {
            valores = new GerencialDao().getView(campos, jTviewnome.getText(), group);
        }

        //mostra o relatorio             
        new ReportGerencial(campos, valores, jTviewdescricao.getText(), group);

    }

    private void setReport(String nomereport, String nomeview) {
        List<ReportBeans> lrb = new ArrayList<>();
        for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
            ReportBeans rb = new ReportBeans();
            rb.setCampos(jTviewcampos.getValueAt(i, 0).toString());
            rb.setAgrupar((Boolean) jTviewcampos.getValueAt(i, 1));
            rb.setCondicao(jTviewcampos.getValueAt(i, 2).toString());
            rb.setValor(jTviewcampos.getValueAt(i, 3).toString());
            lrb.add(rb);
        }
        try {
            new ReportDao().setReport(lrb, nomeview, nomereport);
            jCnomereport.addItem(nomereport);
            jCnomereport.setSelectedItem(nomereport);
        } catch (SQLException ex) {
            JOptionPane.showMessageDialog(null, "Erro ao Salvar Relatório\n" + ex, "Relatório", JOptionPane.ERROR_MESSAGE);
        }

    }

    private void updateReport(String nomereport, String nomeview) {
        List<ReportBeans> lrb = new ArrayList<>();
        for (int i = 0; i < jTviewcampos.getRowCount(); i++) {
            ReportBeans rb = new ReportBeans();
            rb.setCampos(jTviewcampos.getValueAt(i, 0).toString());
            rb.setAgrupar((Boolean) jTviewcampos.getValueAt(i, 1));
            rb.setCondicao(jTviewcampos.getValueAt(i, 2).toString());
            rb.setValor(jTviewcampos.getValueAt(i, 3).toString());
            lrb.add(rb);
        }
        try {
            new ReportDao().delReport(nomeview, nomereport);
            new ReportDao().setReport(lrb, nomeview, nomereport);
            jCnomereport.setSelectedItem(nomereport);
        } catch (SQLException ex) {
            JOptionPane.showMessageDialog(null, "Erro ao Alterar Relatório\n" + ex, "Relatório", JOptionPane.ERROR_MESSAGE);
        }

    }

    private void getReport(String nomeview) {
        List<ReportBeans> lrb = new ArrayList<>();
        lrb = new ReportDao().getReport(nomeview);
        jCnomereport.removeAllItems();
        jCnomereport.addItem("");
        for (ReportBeans rb : lrb) {
            jCnomereport.addItem(rb.getNomereport());
        }
    }

    private void getCamposReport(String nomeview, String nomereport) {
        List<ReportBeans> lrb = new ArrayList<>();
        lrb = new ReportDao().getCamposReport(nomeview, nomereport);
        DefaultTableModel tabelacampos = (DefaultTableModel) jTviewcampos.getModel();
        tabelacampos.setNumRows(0);
        for (ReportBeans rb : lrb) {
            tabelacampos.addRow(new Object[]{rb.getCampos(), rb.getAgrupar(), rb.getCondicao(), rb.getValor()});
        }
    }

    private boolean verCamposAdc(String campo) {
        for(int i=0;i<jTviewcampos.getRowCount();i++){
            if(campo.equals(jTviewcampos.getValueAt(i, 0))){
                JOptionPane.showMessageDialog(this, "Campos já Adicionado");
                return false;
            }
        }
        return true;
    }

}
